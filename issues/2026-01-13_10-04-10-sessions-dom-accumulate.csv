"id","priority","phase","area","title","description","acceptance_criteria","test_mcp","review_initial_requirements","review_regression_requirements","dev_state","review_initial_state","review_regression_state","git_state","owner","refs","notes"
"SESS-010","P0","1","frontend","建立 Playwright 最小复现脚本","复用或新增最小 Playwright 脚本打开指定 sessions 会话页，作为可重复的复现与回归入口。","脚本可执行并打开目标 URL；生成截图或 trace（任一即可）；退出码为 0。","AUTOE2E","脚本不依赖人工点击；会话 ID/URL 可参数化；trace/截图输出路径可配置且不污染工作区。","修复完成后重复执行 3 次稳定通过；等待策略基于可见条件而非固定 sleep，避免 flaky。","进行中","进行中","未开始","未提交","","plan/2026-01-13_10-01-33-sessions-dom-accumulate.md:16;plan/2026-01-13_10-01-33-sessions-dom-accumulate.md:13","picked_reason:先建立可复现与后续回归入口"
"SESS-020","P0","2","frontend","Playwright 注入登录 token","确认前端鉴权 token 的存储/字段名，并在 Playwright 中注入 token 后刷新进入会话页。","无需手动登录即可进入目标会话页；无跳转回登录页；页面出现会话内容（至少能定位到消息列表容器）。","AUTOE2E","token 注入方式与前端实现一致（localStorage/cookie/header）；避免把 token 写进长期配置文件；仅用于 dev 复现脚本。","回归时可用 env var 传入 token（若项目支持）；脚本在 token 失效时给出清晰报错而非静默失败。","未开始","未开始","未开始","未提交","","plan/2026-01-13_10-01-33-sessions-dom-accumulate.md:17;plan/2026-01-13_10-01-33-sessions-dom-accumulate.md:36",""
"SESS-030","P0","3","frontend","量化 DOM 累积现象（计数+trace）","在 Playwright 中统计 `.py-1.min-w-0.max-w-full.overflow-x-hidden` 节点数，循环滚动并记录序列，固化为可审计证据。","执行“向下滚动→停顿→重复 N 次”后，产出包含每轮 DOM 计数的日志/附件；可稳定复现“计数增长”或“计数不增长”的结果。","AUTOE2E","计数逻辑使用稳定选择器与明确滚动容器；trace/截图能定位到页面底部累积区域。","修复后重复相同滚动流程，DOM 计数不应出现无界单调增长；证据可对比（trace/日志）。","未开始","未开始","未开始","未提交","","plan/2026-01-13_10-01-33-sessions-dom-accumulate.md:18;plan/2026-01-13_10-01-33-sessions-dom-accumulate.md:40",""
"SESS-040","P0","4","both","判定根因类别（数据重复 vs 渲染/订阅泄漏）","通过对照消息数据（去重后的 message id 数）与 DOM 节点数/渲染行为，明确问题属于数据重复还是渲染/订阅泄漏。","输出明确结论（两选一或组合）并附证据：例如重复 message id 统计/网络与 WS-SSE 事件对照/DOM 节点复用与卸载观察；在 PR 描述或任务记录中可复核。","AUTOE2E","特别关注 React StrictMode 下 effect 双执行；结论必须能解释“底部累积、上滑到顶端消失”的现象。","修复后复核同样证据链：message id 不重复、订阅不重复、DOM 不异常累积；并确认没有引入消息丢失。","未开始","未开始","未开始","未提交","","plan/2026-01-13_10-01-33-sessions-dom-accumulate.md:19;plan/2026-01-13_10-01-33-sessions-dom-accumulate.md:34",""
"SESS-050","P1","5","both","定位代码入口与数据链路","定位目标 class 所在组件、路由 `/sessions/:id` 入口、消息列表渲染与数据写入（历史分页 + WS/SSE 增量）链路。","在 PR/任务记录中列出关键代码位置（组件/订阅初始化/merge-reducer）与改动边界；能指向导致重复的具体合并点或订阅点。","AUTOFRONTEND","用 `rg` 从目标 class/路由入手，确保定位结果可复现；避免大范围改动，优先最小可修复点。","最终回归需覆盖：首次进入、反复进入、滚动分页、实时增量到达、切换会话再返回等路径。","未开始","未开始","未开始","未提交","","plan/2026-01-13_10-01-33-sessions-dom-accumulate.md:22;plan/2026-01-13_10-01-33-sessions-dom-accumulate.md:23",""
"SESS-060","P0","6","both","实现最小根因修复（幂等订阅/去重/稳定 key）","按定位结果选择最小改动：修复重复订阅（正确 cleanup、稳定依赖）、分页/流合并去重（按 message id 幂等）、列表 key 稳定唯一/虚拟列表 itemKey 正确。","在复现脚本下：同一 message id 只渲染一次；DOM 节点数与去重后的消息条数保持一致（允许虚拟列表合理 overscan）；滚动 30 次不出现无界累积；上滑到顶端不再出现清空闪烁。","AUTOFRONTEND","优先治本而非关闭 StrictMode；确保订阅创建/销毁对称；去重逻辑不引入乱序/丢消息。","回归验证覆盖多会话切换与长时间运行（≥2 分钟）；确认性能无明显退化（滚动不卡顿）。","未开始","未开始","未开始","未提交","","plan/2026-01-13_10-01-33-sessions-dom-accumulate.md:25;plan/2026-01-13_10-01-33-sessions-dom-accumulate.md:26",""
"SESS-070","P1","7","frontend","新增 E2E 回归用例与人工复测清单","将复现流程固化为 Playwright 回归用例，并补充最小人工复测步骤，确保后续不回归。","新增/更新 Playwright 用例：自动注入 token→打开会话页→循环滚动→断言无重复渲染/无无界累积/无清空闪烁；本地可稳定跑通。","AUTOE2E","用例断言尽量量化（计数/唯一性）并避免脆弱选择器；必要时增加 trace 便于失败排查。","回归执行包含：冷启动、刷新、切换会话、长时间停留；并保留失败时的 trace 产物。","未开始","未开始","未开始","未提交","","plan/2026-01-13_10-01-33-sessions-dom-accumulate.md:29;plan/2026-01-13_10-01-33-sessions-dom-accumulate.md:31",""
